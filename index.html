<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tools for Bayesian Analyses • BayesTools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Tools for Bayesian Analyses">
<meta property="og:description" content="Provides tools for conducting Bayesian analyses. The package contains 
    functions for creating a wide range of prior distribution objects, mixing posterior 
    samples from JAGS and Stan models, plotting posterior distributions, and etc...
    The tools for working with prior distribution span from visualization, generating JAGS 
    and bridgesampling syntax to basic functions such as rng, quantile, and distribution functions. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">BayesTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/ComparisonR.html">Comparison to other R packages</a>
    </li>
    <li>
      <a href="articles/SpikeAndSlab.html">Bayes factors via spike and slab prior vs. bridge sampling</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/FBartos/BayesTools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="bayestools">BayesTools<a class="anchor" aria-label="anchor" href="#bayestools"></a>
</h1></div>
<!-- badges: start -->
<p>The goal of BayesTools is to provide functions that simplify building R packages focused on Bayesian inference and Bayesian model-averaging.</p>
<p>Currently, the package provides several tools:</p>
<ul>
<li>prior distribution (with S3 methods for plot/print/pdf/cdf/rng/…)</li>
<li>JAGS models automation (generating JAGS model syntax and <code>bridgesampling</code> marginal likelihood functions for prior distributions, various wrappers, …)</li>
<li>model-averaging (mixing posterior distributions, computing Bayes factors, generating summary tables, …)</li>
</ul>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the released version of BayesTools from <a href="https://CRAN.R-project.org" class="external-link">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BayesTools"</span><span class="op">)</span></code></pre></div>
<p>And the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"FBartos/BayesTools"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="prior-distributions">Prior Distributions<a class="anchor" aria-label="anchor" href="#prior-distributions"></a>
</h2>
<p>Prior distribution can be created with the <code>prior</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbartos.github.io/BayesTools/" class="external-link">BayesTools</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required namespace: runjags</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'BayesTools'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     sd, var</span>
<span class="co">#&gt; The following object is masked from 'package:grDevices':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     pdf</span>

<span class="va">p0</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/prior.html">prior</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="st">"point"</span>,  parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/prior.html">prior</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="st">"normal"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/prior.html">prior</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="st">"normal"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, truncation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The priors can be easily visualized with many possible arguments</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p0</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="50%"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p1</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"blue"</span>, par_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-2.png" width="50%"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p2</span>, plot_type <span class="op">=</span> <span class="st">"ggplot"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-3.png" width="50%"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p2</span>, plot_type <span class="op">=</span> <span class="st">"ggplot"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="reference/geom_prior.html">geom_prior</a></span><span class="op">(</span><span class="va">p1</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-4.png" width="50%"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p1</span>, transformation <span class="op">=</span> <span class="st">"exp"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-5.png" width="50%"></p>
<p>All priors also contain some basic S3 methods.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># S3 methods</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="reference/prior_functions_methods.html">rng</a></span><span class="op">(</span><span class="va">p0</span>, <span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt;  [1] 0 0 0 0 0 0 0 0 0 0</span>
<span class="fu"><a href="reference/prior_functions_methods.html">rng</a></span><span class="op">(</span><span class="va">p1</span>, <span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt;  [1] -0.6264538  0.1836433 -0.8356286  1.5952808  0.3295078 -0.8204684</span>
<span class="co">#&gt;  [7]  0.4874291  0.7383247  0.5757814 -0.3053884</span>
<span class="fu"><a href="reference/prior_functions_methods.html">rng</a></span><span class="op">(</span><span class="va">p2</span>, <span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt;  [1] 0.38984324 1.12493092 0.94383621 0.82122120 0.59390132 0.91897737</span>
<span class="co">#&gt;  [7] 0.78213630 0.07456498 0.61982575 0.41794156</span>

<span class="fu"><a href="reference/prior_functions_methods.html">pdf</a></span><span class="op">(</span><span class="va">p0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1]   0 Inf   0</span>
<span class="fu"><a href="reference/prior_functions_methods.html">pdf</a></span><span class="op">(</span><span class="va">p1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.2419707 0.3989423 0.2419707</span>
<span class="fu"><a href="reference/prior_functions_methods.html">pdf</a></span><span class="op">(</span><span class="va">p2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.0000000 0.7978846 0.4839414</span>

<span class="fu"><a href="reference/prior_functions_methods.html">cdf</a></span><span class="op">(</span><span class="va">p0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0 1 1</span>
<span class="fu"><a href="reference/prior_functions_methods.html">cdf</a></span><span class="op">(</span><span class="va">p1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.1586553 0.5000000 0.8413447</span>
<span class="fu"><a href="reference/prior_functions_methods.html">cdf</a></span><span class="op">(</span><span class="va">p2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.0000000 0.0000000 0.6826895</span>

<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">p0</span><span class="op">)</span>
<span class="co">#&gt; [1] 0</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span>
<span class="co">#&gt; [1] 0</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.7978846</span>

<span class="fu"><a href="reference/sd.html">sd</a></span><span class="op">(</span><span class="va">p0</span><span class="op">)</span>
<span class="co">#&gt; [1] 0</span>
<span class="fu"><a href="reference/sd.html">sd</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span>
<span class="co">#&gt; [1] 1</span>
<span class="fu"><a href="reference/sd.html">sd</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.6028103</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p0</span><span class="op">)</span>
<span class="co">#&gt; Spike(0)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p1</span>, short_name <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; N(0, 1)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="jags-automation">JAGS Automation<a class="anchor" aria-label="anchor" href="#jags-automation"></a>
</h2>
<p>The packages simplifies development of JAGS models by automatically taking care of the prior distributions relevant portion of the code.</p>
<p>First, we generate few samples from a normal distribution and use the previously specified prior distributions as priors for the mean (passed with a list).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get some data</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,
  N <span class="op">=</span> <span class="fl">10</span>
<span class="op">)</span>
<span class="va">data</span><span class="op">$</span><span class="va">x</span>
<span class="co">#&gt;  [1] -0.6264538  0.1836433 -0.8356286  1.5952808  0.3295078 -0.8204684</span>
<span class="co">#&gt;  [7]  0.4874291  0.7383247  0.5757814 -0.3053884</span>

<span class="co">## create and fit models</span>
<span class="co"># define priors</span>
<span class="va">priors_list0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="va">p0</span><span class="op">)</span>
<span class="va">priors_list1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="va">p1</span><span class="op">)</span>
<span class="va">priors_list2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="va">p2</span><span class="op">)</span></code></pre></div>
<p>We create a <code>model_syntax</code> that defines likelihood of the data for the JAGs model and fit the models with the <code>JAGS_fit</code> wrapper that automatically adds prior distributions to the syntax, generates starting values, creates list of monitored variables, and contains additional control options (most of the functionality is build upon <code>runjags</code> package).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># define likelihood for the data</span>
<span class="va">model_syntax</span> <span class="op">&lt;-</span>
  <span class="st">"model{
    for(i in 1:N){
      x[i] ~ dnorm(mu, 1)
    }
  }"</span>

<span class="co"># fit the models</span>
<span class="va">fit0</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/JAGS_fit.html">JAGS_fit</a></span><span class="op">(</span><span class="va">model_syntax</span>, <span class="va">data</span>, <span class="va">priors_list0</span>, seed <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Loading required namespace: rjags</span>
<span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/JAGS_fit.html">JAGS_fit</a></span><span class="op">(</span><span class="va">model_syntax</span>, <span class="va">data</span>, <span class="va">priors_list1</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/JAGS_fit.html">JAGS_fit</a></span><span class="op">(</span><span class="va">model_syntax</span>, <span class="va">data</span>, <span class="va">priors_list2</span>, seed <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p>The <code>runjags_estimates_table</code> function then provides a nicely formated summary for the fitted model.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># formatted summary tables</span>
<span class="fu"><a href="reference/BayesTools_model_tables.html">runjags_estimates_table</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="va">priors_list1</span><span class="op">)</span>
<span class="co">#&gt;     Mean    SD    lCI Median   uCI error(MCMC) error(MCMC)/SD   ESS R-hat</span>
<span class="co">#&gt; mu 0.116 0.304 -0.469  0.117 0.715     0.00242          0.008 15748 1.000</span></code></pre></div>
<p>We create a <code>log_posterior</code> function that defines the log likelihood of the data for marginal likelihood estimation via <code>bridgesampling</code> (while creating a dummy bridge sampling object for the model without any posterior samples).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># define log posterior for bridge sampling</span>
<span class="va">log_posterior</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">parameters</span>, <span class="va">data</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">x</span>, <span class="va">parameters</span><span class="op">$</span><span class="va">mu</span>, <span class="fl">1</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># get marginal likelihoods</span>
<span class="va">marglik0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  logml <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">p0</span><span class="op">)</span>, <span class="fl">1</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">marglik0</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"bridge"</span>
<span class="va">marglik1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/JAGS_bridgesampling.html">JAGS_bridgesampling</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="va">data</span>, <span class="va">priors_list1</span>, <span class="va">log_posterior</span><span class="op">)</span>
<span class="va">marglik2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/JAGS_bridgesampling.html">JAGS_bridgesampling</a></span><span class="op">(</span><span class="va">fit2</span>, <span class="va">data</span>, <span class="va">priors_list2</span>, <span class="va">log_posterior</span><span class="op">)</span>

<span class="va">marglik1</span>
<span class="co">#&gt; Bridge sampling estimate of the log marginal likelihood: -13.1383</span>
<span class="co">#&gt; Estimate obtained in 4 iteration(s) via method "normal".</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-averaging">Model-Averaging<a class="anchor" aria-label="anchor" href="#model-averaging"></a>
</h2>
<p>The package also simplifies implementation of Bayesian model-averaging (see e.g., <code>RoBMA</code> package).</p>
<p>First, we create a list of model objects, each containing the JAGS fit, marginal likelihood, list of prior distribution, prior weights, and generated model summaries. Then we apply the <code>models_inference</code> automatically calculating basic model-averaging information. Finally, we can use <code>model_summary_table</code> to summarize the individual models.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## create an object with the models</span>
<span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit0</span>, marglik <span class="op">=</span> <span class="va">marglik0</span>, priors <span class="op">=</span> <span class="va">priors_list0</span>, prior_weights <span class="op">=</span> <span class="fl">1</span>, fit_summary <span class="op">=</span> <span class="fu"><a href="reference/BayesTools_model_tables.html">runjags_estimates_table</a></span><span class="op">(</span><span class="va">fit0</span>, <span class="va">priors_list0</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit1</span>, marglik <span class="op">=</span> <span class="va">marglik1</span>, priors <span class="op">=</span> <span class="va">priors_list1</span>, prior_weights <span class="op">=</span> <span class="fl">1</span>, fit_summary <span class="op">=</span> <span class="fu"><a href="reference/BayesTools_model_tables.html">runjags_estimates_table</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="va">priors_list1</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit2</span>, marglik <span class="op">=</span> <span class="va">marglik2</span>, priors <span class="op">=</span> <span class="va">priors_list2</span>, prior_weights <span class="op">=</span> <span class="fl">1</span>, fit_summary <span class="op">=</span> <span class="fu"><a href="reference/BayesTools_model_tables.html">runjags_estimates_table</a></span><span class="op">(</span><span class="va">fit2</span>, <span class="va">priors_list2</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="co"># compare and summarize the models</span>
<span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ensemble_inference.html">models_inference</a></span><span class="op">(</span><span class="va">models</span><span class="op">)</span>

<span class="co"># create model-summaries</span>
<span class="fu"><a href="reference/BayesTools_model_tables.html">model_summary_table</a></span><span class="op">(</span><span class="va">models</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;                                                                 </span>
<span class="co">#&gt;  Model               1             Parameter prior distributions</span>
<span class="co">#&gt;  Prior prob.     0.333                                          </span>
<span class="co">#&gt;  log(marglik)   -12.02                                          </span>
<span class="co">#&gt;  Post. prob.     0.570                                          </span>
<span class="co">#&gt;  Inclusion BF    2.655</span>
<span class="fu"><a href="reference/BayesTools_model_tables.html">model_summary_table</a></span><span class="op">(</span><span class="va">models</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;                                                                 </span>
<span class="co">#&gt;  Model               2             Parameter prior distributions</span>
<span class="co">#&gt;  Prior prob.     0.333                         mu ~ Normal(0, 1)</span>
<span class="co">#&gt;  log(marglik)   -13.14                                          </span>
<span class="co">#&gt;  Post. prob.     0.186                                          </span>
<span class="co">#&gt;  Inclusion BF    0.458</span>
<span class="fu"><a href="reference/BayesTools_model_tables.html">model_summary_table</a></span><span class="op">(</span><span class="va">models</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;                                                                 </span>
<span class="co">#&gt;  Model               3             Parameter prior distributions</span>
<span class="co">#&gt;  Prior prob.     0.333                 mu ~ Normal(0, 1)[0, Inf]</span>
<span class="co">#&gt;  log(marglik)   -12.87                                          </span>
<span class="co">#&gt;  Post. prob.     0.243                                          </span>
<span class="co">#&gt;  Inclusion BF    0.644</span></code></pre></div>
<p>Moreover, we can draw inference based on the whole ensemble for the common parameters with the <code>ensemble_inference</code> function, or mixed the posterior distributions based on marginal likelihoods with the <code>mix_posteriors</code> functions. The various summary functions then create tables for the inference, estimates, model summary, and MCMC diagnostics.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## draw model based inference</span>
<span class="va">inference</span>          <span class="op">&lt;-</span> <span class="fu"><a href="reference/ensemble_inference.html">ensemble_inference</a></span><span class="op">(</span>model_list <span class="op">=</span> <span class="va">models</span>, parameters <span class="op">=</span> <span class="st">"mu"</span>, is_null_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mu"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="co"># automatically mix posteriors</span>
<span class="va">mixed_posteriors</span>   <span class="op">&lt;-</span> <span class="fu"><a href="reference/mix_posteriors.html">mix_posteriors</a></span><span class="op">(</span>model_list <span class="op">=</span> <span class="va">models</span>, parameters <span class="op">=</span> <span class="st">"mu"</span>, is_null_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mu"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="co"># summarizes the model-averaging summary</span>
<span class="fu"><a href="reference/BayesTools_ensemble_tables.html">ensemble_inference_table</a></span><span class="op">(</span><span class="va">inference</span>, parameters <span class="op">=</span> <span class="st">"mu"</span><span class="op">)</span>
<span class="co">#&gt;    Models Prior prob. Post. prob. Inclusion BF</span>
<span class="co">#&gt; mu    2/3       0.667       0.430        0.377</span>
<span class="fu"><a href="reference/BayesTools_ensemble_tables.html">ensemble_estimates_table</a></span><span class="op">(</span><span class="va">mixed_posteriors</span>,  parameters <span class="op">=</span> <span class="st">"mu"</span><span class="op">)</span>
<span class="co">#&gt;     Mean Median  0.025  0.95</span>
<span class="co">#&gt; mu 0.091  0.000 -0.218 0.523</span>
<span class="fu"><a href="reference/BayesTools_ensemble_tables.html">ensemble_summary_table</a></span><span class="op">(</span><span class="va">models</span>, parameters <span class="op">=</span> <span class="st">"mu"</span><span class="op">)</span>
<span class="co">#&gt;  Model       Prior mu       Prior prob. log(marglik) Post. prob. Inclusion BF</span>
<span class="co">#&gt;      1                            0.333       -12.02       0.570        2.655</span>
<span class="co">#&gt;      2         Normal(0, 1)       0.333       -13.14       0.186        0.458</span>
<span class="co">#&gt;      3 Normal(0, 1)[0, Inf]       0.333       -12.87       0.243        0.644</span>
<span class="fu"><a href="reference/BayesTools_ensemble_tables.html">ensemble_diagnostics_table</a></span><span class="op">(</span><span class="va">models</span>, parameters <span class="op">=</span> <span class="st">"mu"</span>, remove_spike_0 <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt;  Model       Prior mu       max[error(MCMC)] max[error(MCMC)/SD] min(ESS)</span>
<span class="co">#&gt;      1             Spike(0)               NA                  NA       NA</span>
<span class="co">#&gt;      2         Normal(0, 1)          0.00242               0.008    15748</span>
<span class="co">#&gt;      3 Normal(0, 1)[0, Inf]          0.00162               0.008    16078</span>
<span class="co">#&gt;  max(R-hat)</span>
<span class="co">#&gt;          NA</span>
<span class="co">#&gt;       1.000</span>
<span class="co">#&gt;       1.000</span></code></pre></div>
<p>The packages also provides functions for plotting model-averaged posterior distributions.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### plotting</span>
<span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/on.exit.html" class="external-link">on.exit</a></span><span class="op">(</span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="va">oldpar</span><span class="op">[[</span><span class="st">"mar"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>

<span class="co"># plot model-average posteriors</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="reference/plot_posterior.html">plot_posterior</a></span><span class="op">(</span><span class="va">mixed_posteriors</span>, parameter <span class="op">=</span> <span class="st">"mu"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-11-1.png" width="50%"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/plot_posterior.html">plot_posterior</a></span><span class="op">(</span><span class="va">mixed_posteriors</span>, parameter <span class="op">=</span> <span class="st">"mu"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"black"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>, dots_prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"grey"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-11-2.png" width="50%"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/plot_posterior.html">plot_posterior</a></span><span class="op">(</span><span class="va">mixed_posteriors</span>, parameter <span class="op">=</span> <span class="st">"mu"</span>, transformation <span class="op">=</span> <span class="st">"exp"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>, dots_prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"blue"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-11-3.png" width="50%"></p>
<p>Or comparing estimates from the different models.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/plot_models.html">plot_models</a></span><span class="op">(</span>model_list <span class="op">=</span> <span class="va">models</span>, samples <span class="op">=</span> <span class="va">mixed_posteriors</span>, inference <span class="op">=</span> <span class="va">inference</span>, parameter <span class="op">=</span> <span class="st">"mu"</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="50%"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/plot_models.html">plot_models</a></span><span class="op">(</span>model_list <span class="op">=</span> <span class="va">models</span>, samples <span class="op">=</span> <span class="va">mixed_posteriors</span>, inference <span class="op">=</span> <span class="va">inference</span>, parameter <span class="op">=</span> <span class="st">"mu"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>, plot_type <span class="op">=</span> <span class="st">"ggplot"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-2.png" width="50%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=BayesTools" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/FBartos/BayesTools/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/FBartos/BayesTools/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing BayesTools</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>František Bartoš <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-0018-5573" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/FBartos/BayesTools/actions" class="external-link"><img src="https://github.com/FBartos/BayesTools/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/FBartos/BayesTools?branch=master" class="external-link"><img src="https://codecov.io/gh/FBartos/BayesTools/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://cran.r-project.org/package=BayesTools" class="external-link"><img src="https://www.r-pkg.org/badges/version/BayesTools" alt="CRAN_Status_Badge"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by František Bartoš.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
