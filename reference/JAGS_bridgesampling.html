<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute marginal likelihood of a 'JAGS' model — JAGS_bridgesampling • BayesTools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute marginal likelihood of a 'JAGS' model — JAGS_bridgesampling"><meta property="og:description" content="A wrapper around
bridge_sampler that automatically
computes likelihood part dependent on the prior distribution
and prepares parameter samples. log_posterior must
specify a function that takes two arguments - a named list
of samples from the prior distributions and the data, and returns
log likelihood of the model part."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BayesTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/ComparisonR.html">Comparison to other R packages</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/FBartos/BayesTools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute marginal likelihood of a 'JAGS' model</h1>
    <small class="dont-index">Source: <a href="https://github.com/FBartos/BayesTools/blob/HEAD/R/JAGS-marglik.R" class="external-link"><code>R/JAGS-marglik.R</code></a></small>
    <div class="hidden name"><code>JAGS_bridgesampling.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A wrapper around
<a href="https://rdrr.io/pkg/bridgesampling/man/bridge_sampler.html" class="external-link">bridge_sampler</a> that automatically
computes likelihood part dependent on the prior distribution
and prepares parameter samples. <code>log_posterior</code> must
specify a function that takes two arguments - a named list
of samples from the prior distributions and the data, and returns
log likelihood of the model part.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">JAGS_bridgesampling</span><span class="op">(</span>
  <span class="va">fit</span>,
  <span class="va">log_posterior</span>,
  data <span class="op">=</span> <span class="cn">NULL</span>,
  prior_list <span class="op">=</span> <span class="cn">NULL</span>,
  formula_list <span class="op">=</span> <span class="cn">NULL</span>,
  formula_data_list <span class="op">=</span> <span class="cn">NULL</span>,
  formula_prior_list <span class="op">=</span> <span class="cn">NULL</span>,
  add_parameters <span class="op">=</span> <span class="cn">NULL</span>,
  add_bounds <span class="op">=</span> <span class="cn">NULL</span>,
  maxiter <span class="op">=</span> <span class="fl">10000</span>,
  silent <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>fit</dt>
<dd><p>model fitted with either <a href="https://rdrr.io/pkg/runjags/man/runjags-package.html" class="external-link">runjags</a> posterior
samples obtained with <a href="https://rdrr.io/pkg/rjags/man/rjags-package.html" class="external-link">rjags-package</a></p></dd>
<dt>log_posterior</dt>
<dd><p>function that takes a named list of samples, the data,
and additional list of parameters passed as <code>...</code> as input and
returns the log of the unnormalized posterior density of the model part</p></dd>
<dt>data</dt>
<dd><p>list containing data to fit the model (not including data for the formulas)</p></dd>
<dt>prior_list</dt>
<dd><p>named list of prior distribution
(names correspond to the parameter names) of parameters not specified within the
<code>formula_list</code></p></dd>
<dt>formula_list</dt>
<dd><p>named list of formulas to be added to the model
(names correspond to the parameter name created by each of the formula)</p></dd>
<dt>formula_data_list</dt>
<dd><p>named list of data frames containing data for each formula
(names of the lists correspond to the parameter name created by each of the formula)</p></dd>
<dt>formula_prior_list</dt>
<dd><p>named list of named lists of prior distributions
(names of the lists correspond to the parameter name created by each of the formula and
the names of the prior distribution correspond to the parameter names) of parameters specified
within the <code>formula</code></p></dd>
<dt>add_parameters</dt>
<dd><p>vector of additional parameter names that should be used
in bridgesampling but were not specified in the <code>prior_list</code></p></dd>
<dt>add_bounds</dt>
<dd><p>list with two name vectors (<code>"lb"</code> and <code>"up"</code>)
containing lower and upper bounds of the additional parameters that were not
specified in the <code>prior_list</code></p></dd>
<dt>maxiter</dt>
<dd><p>maximum number of iterations for the
<a href="https://rdrr.io/pkg/bridgesampling/man/bridge_sampler.html" class="external-link">bridge_sampler</a></p></dd>
<dt>silent</dt>
<dd><p>whether the progress should be printed, defaults to <code>TRUE</code></p></dd>
<dt>...</dt>
<dd><p>additional argument to the <a href="https://rdrr.io/pkg/bridgesampling/man/bridge_sampler.html" class="external-link">bridge_sampler</a>
and <code>log_posterior</code> function</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>JAGS_bridgesampling</code> returns an object of class 'bridge'.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># simulate data</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,</span>
<span class="r-in">  N <span class="op">=</span> <span class="fl">10</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">data</span><span class="op">$</span><span class="va">x</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># define priors</span></span>
<span class="r-in"><span class="va">priors_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="prior.html">prior</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># define likelihood for the data</span></span>
<span class="r-in"><span class="va">model_syntax</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="st">"model{</span>
<span class="r-in">    for(i in 1:N){</span>
<span class="r-in">      x[i] ~ dnorm(mu, 1)</span>
<span class="r-in">    }</span>
<span class="r-in">  }"</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># fit the models</span></span>
<span class="r-in"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="JAGS_fit.html">JAGS_fit</a></span><span class="op">(</span><span class="va">model_syntax</span>, <span class="va">data</span>, <span class="va">priors_list</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># define log posterior for bridge sampling</span></span>
<span class="r-in"><span class="va">log_posterior</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">parameters</span>, <span class="va">data</span><span class="op">)</span><span class="op">{</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">x</span>, <span class="va">parameters</span><span class="op">$</span><span class="va">mu</span>, <span class="fl">1</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># get marginal likelihoods</span></span>
<span class="r-in"><span class="va">marglik</span> <span class="op">&lt;-</span> <span class="fu">JAGS_bridgesampling</span><span class="op">(</span><span class="va">fit</span>, <span class="va">log_posterior</span>, <span class="va">data</span>, <span class="va">priors_list</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by František Bartoš.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

