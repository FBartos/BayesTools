<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bayes factors via spike and slab prior vs. bridge sampling • BayesTools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Bayes factors via spike and slab prior vs. bridge sampling">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BayesTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.22</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ComparisonR.html">Comparison to other R packages</a>
    </li>
    <li>
      <a href="../articles/SpikeAndSlab.html">Bayes factors via spike and slab prior vs. bridge sampling</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/FBartos/BayesTools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Bayes factors via spike and slab prior
vs. bridge sampling</h1>
                        <h4 data-toc-skip class="author">František
Bartoš</h4>
            
            <h4 data-toc-skip class="date">2025-09-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/FBartos/BayesTools/blob/master/vignettes/SpikeAndSlab.Rmd" class="external-link"><code>vignettes/SpikeAndSlab.Rmd</code></a></small>
      <div class="hidden name"><code>SpikeAndSlab.Rmd</code></div>

    </div>

    
    
<p>One of the main features of BayesTools is assistance in generating
JAGS <span class="citation">(Plummer, 2003)</span> code based on
formulas and prior distribution objects and subsequent estimation of
marginal likelihoods with the bridgesampling R package <span class="citation">(Gronau et al., 2020)</span>. Marginal likelihoods,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">data</mtext><mo>∣</mo><mi>ℳ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(\text{data} \mid \mathcal{M})</annotation></semantics></math>,
are the key ingredient for computing Bayes factors,</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">BF</mtext><mn>10</mn></msub><mo>=</mo><mfrac><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">data</mtext><mo>∣</mo><msub><mi>ℳ</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">data</mtext><mo>∣</mo><msub><mi>ℳ</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{BF}_{10} = \frac{p(\text{data} \mid \mathcal{M}_{1})}{p(\text{data} \mid \mathcal{M}_{0})}</annotation></semantics></math>,</p>
<p>which quantify relative predictive performance of two competing
models <span class="citation">(Kass &amp; Raftery, 1995; Rouder &amp;
Morey, 2019; Wrinch &amp; Jeffreys, 1921)</span>. Convenient model
specification then allows users and package developers to easily compute
Bayes factors and test a wide range of informed hypotheses. See RoBMA
<span class="citation">(Bartoš &amp; Maier, 2020)</span> and <span class="citation">(Bartoš, 2022)</span> R packages for implementation
examples.</p>
<p>However, when considering a simple regression, the model space of all
possible models increases exponentially with additional predictors.
I.e., the possibility of including vs. excluding
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
predictors leads to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>2</mn><mi>k</mi></msup><annotation encoding="application/x-tex">2^k</annotation></semantics></math>
possible submodels that need to be computed. Even relatively
computationally simple models (e.g. ~ 1 min of computation) with 10
possible predictors would result in more than 17 hours of computation.
Therefore, we might require more computationally efficient methods when
performing variable selection with more than a few covariates. In this
vignette, I showcase how to use BayesTools package to specify spike and
slab priors that aim to explore most of the model space and obtain
posterior inclusion probabilities for each predictor within a single
MCMC run <span class="citation">(Kuo &amp; Mallick, 1998; O’Hara &amp;
Sillanpää, 2009)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbartos.github.io/BayesTools/" class="external-link">BayesTools</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'BayesTools'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     sd, var</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:grDevices':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     pdf</span></span></code></pre></div>
<div class="section level2">
<h2 id="simulated-data">Simulated Data<a class="anchor" aria-label="anchor" href="#simulated-data"></a>
</h2>
<p>To keep it simple, let’s consider a linear regression with one
continuous predictor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>.
We simulate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">N = 100</annotation></semantics></math>
observations of a dependent variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
under the presence of a small effect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
of a continuous predictor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="op">-</span><span class="fl">68</span><span class="op">)</span> <span class="co"># set seed for reproducibility</span></span>
<span></span>
<span><span class="va">N</span>     <span class="op">&lt;-</span> <span class="fl">100</span>      <span class="co"># number of observations</span></span>
<span><span class="va">x</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span> <span class="co"># continuous predictor</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.5</span>     <span class="co"># intercept</span></span>
<span><span class="va">beta</span>  <span class="op">&lt;-</span> <span class="fl">0.15</span>     <span class="co"># small effect</span></span>
<span></span>
<span><span class="co"># compute the mean parameter for each predictor value</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">alpha</span> <span class="op">+</span> <span class="va">beta</span> <span class="op">*</span> <span class="va">x</span></span>
<span></span>
<span><span class="co"># generate the response for each observation </span></span>
<span><span class="va">y</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span></code></pre></div>
<p>We quickly verify that our simulated data correspond to the desired
settings (up to a random error) with the <code>lm</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = y ~ x)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -2.2960 -0.6832  0.0683  0.7448  2.3815 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  -0.5487     0.1032  -5.315  6.7e-07 ***</span></span>
<span><span class="co">#&gt; x             0.1962     0.1010   1.943   0.0549 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.03 on 98 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.03708,    Adjusted R-squared:  0.02725 </span></span>
<span><span class="co">#&gt; F-statistic: 3.774 on 1 and 98 DF,  p-value: 0.05494</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-specification">Model Specification<a class="anchor" aria-label="anchor" href="#model-specification"></a>
</h2>
<p>We consider two following models:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ℳ</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\mathcal{M}_0</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta = 0</annotation></semantics></math>
</li>
<li>and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ℳ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\mathcal{M}_1</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>∼</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta \sim g()</annotation></semantics></math>,</li>
</ul>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g()</annotation></semantics></math>
characterizes our hypothesis about the degree of the effect. In our
example, we specify a simple two-sided hypothesis represented by a
normal distribution with mean 0 and standard deviation 0.5, e.g.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>∼</mo><mtext mathvariant="normal">Normal</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mn>0.5</mn><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta \sim \text{Normal}(0, 0.5^2)</annotation></semantics></math>.</p>
</div>
<div class="section level2">
<h2 id="maginal-likelihoods">Maginal Likelihoods<a class="anchor" aria-label="anchor" href="#maginal-likelihoods"></a>
</h2>
<p>First, we compute the Bayes factor model comparison via marginal
likelihoods. To do that, we need to specify the likelihood for the
response variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>,</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_likelihood</span> <span class="op">&lt;-</span> </span>
<span><span class="st">"model{</span></span>
<span><span class="st">  for(i in 1:N){</span></span>
<span><span class="st">    y[i] ~ dnorm(mu[i], pow(sigma, -2))</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}</span></span>
<span><span class="st">"</span></span></code></pre></div>
<p>where <code>mu</code> corresponds to the mean parameter (that we
specify via a formula in the next step) and <code>sigma</code> to a
standard deviation of the response variable (that we treat as a nuisance
parameter here).</p>
<p>We specify formulas for the <code>mu</code> parameter of each of the
considered models,</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formula_M0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mu"</span> <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">formula_M1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mu"</span> <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p>where <code>1</code> corresponds to the intercept (it is not
necessary for the second model as it is included by default).</p>
<p>To finish the model specification, we set the prior distribution
corresponding to our hypothesis test of the beta parameter, set a broad
prior distributions for the nuisance intercept and sigma parameters, and
create a list containing data for the model specified within
<code>model_likelihood</code> (in the first step) and a data frame for
the data contained within the formula for mu within
<code>formula_M0</code> and <code>formula_M1</code> (specified in the
second step).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prior on the test parameter</span></span>
<span><span class="va">prior_beta</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="st">"normal"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># priors on the nuisance parameters</span></span>
<span><span class="va">prior_int</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="st">"normal"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">prior_sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="st">"normal"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, truncation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the data list</span></span>
<span><span class="va">data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="va">y</span>,</span>
<span>  N <span class="op">=</span> <span class="va">N</span></span>
<span><span class="op">)</span></span>
<span><span class="va">data_formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">x</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We estimate the models with the <code>JAGS_fit</code> function. Since
we are using the formula interface (which allows us to specify multiple
formulas for different parameters), we need to pass the arguments as
named lists,</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/JAGS_fit.html">JAGS_fit</a></span><span class="op">(</span></span>
<span>  <span class="co"># specification for the `model_likelihood` part</span></span>
<span>  model_syntax <span class="op">=</span> <span class="va">model_likelihood</span>,</span>
<span>  data         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, N <span class="op">=</span> <span class="va">N</span><span class="op">)</span>,</span>
<span>  prior_list   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"sigma"</span> <span class="op">=</span> <span class="va">prior_sigma</span><span class="op">)</span>,</span>
<span></span>
<span>  <span class="co"># specification for the `formula_M0` part </span></span>
<span>  formula_list       <span class="op">=</span> <span class="va">formula_M0</span>,</span>
<span>  formula_prior_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mu"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"intercept"</span> <span class="op">=</span> <span class="va">prior_int</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  formula_data_list  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mu"</span> <span class="op">=</span> <span class="va">data_formula</span><span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co"># seed for reproducibility</span></span>
<span>  seed         <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required namespace: runjags</span></span>
<span><span class="co">#&gt; Loading required namespace: rjags</span></span>
<span></span>
<span><span class="va">M1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/JAGS_fit.html">JAGS_fit</a></span><span class="op">(</span></span>
<span>  model_syntax <span class="op">=</span> <span class="va">model_likelihood</span>,</span>
<span>  data         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, N <span class="op">=</span> <span class="va">N</span><span class="op">)</span>,</span>
<span>  prior_list   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"sigma"</span> <span class="op">=</span> <span class="va">prior_sigma</span><span class="op">)</span>,</span>
<span>  formula_list       <span class="op">=</span> <span class="va">formula_M1</span>,</span>
<span>  formula_prior_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mu"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"intercept"</span> <span class="op">=</span> <span class="va">prior_int</span>, <span class="st">"x"</span> <span class="op">=</span> <span class="va">prior_beta</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  formula_data_list  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mu"</span> <span class="op">=</span> <span class="va">data_formula</span><span class="op">)</span>,</span>
<span>  seed         <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We quickly verify that our parameter estimates (from the full model)
are similar to the frequentist results obtained via <code>lm</code>
function earlier.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/BayesTools_model_tables.html">JAGS_estimates_table</a></span><span class="op">(</span><span class="va">M1</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  Mean    SD    lCI Median    uCI error(MCMC) error(MCMC)/SD</span></span>
<span><span class="co">#&gt; (mu) intercept -0.547 0.104 -0.753 -0.548 -0.341     0.00081          0.008</span></span>
<span><span class="co">#&gt; (mu) x          0.188 0.101 -0.012  0.189  0.385     0.00080          0.008</span></span>
<span><span class="co">#&gt; sigma           1.042 0.076  0.905  1.037  1.205     0.00078          0.010</span></span>
<span><span class="co">#&gt;                  ESS R-hat</span></span>
<span><span class="co">#&gt; (mu) intercept 16408 1.000</span></span>
<span><span class="co">#&gt; (mu) x         15964 1.000</span></span>
<span><span class="co">#&gt; sigma           9502 1.000</span></span></code></pre></div>
<p>To obtain the marginal likelihoods and compute Bayes factors, we only
need to write the likelihood function corresponding to the JAGS model.
Importantly, BayesTools handles all priors and formula related
computation automatically, in other words, we do not need to worry about
computing the mean parameter based on the intercept and predictors since
we already obtain the computed mu in the <code>parameters[["mu"]]</code>
object (a vector with a value for each y),</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log_posterior</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">parameters</span>, <span class="va">data</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span></span>
<span>    x    <span class="op">=</span> <span class="va">data</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    mean <span class="op">=</span> <span class="va">parameters</span><span class="op">[[</span><span class="st">"mu"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    sd   <span class="op">=</span> <span class="va">parameters</span><span class="op">[[</span><span class="st">"sigma"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    log  <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>where the <code>parameters</code> arguments is a list containing the
parameters and <code>data</code> argument is a list containing data. We
use <code>sum(dnorm(..., log = TRUE))</code> to sum the logarithmic
likelihood of all observations.</p>
<p>Finally, we pass our objects to the <code>JAGS_bridgesampling</code>
function to compute the marginal likelihoods.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">marglik_model_H0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/JAGS_bridgesampling.html">JAGS_bridgesampling</a></span><span class="op">(</span></span>
<span>  <span class="co"># specification for the model part</span></span>
<span>  fit           <span class="op">=</span> <span class="va">M0</span>,</span>
<span>  log_posterior <span class="op">=</span> <span class="va">log_posterior</span>,</span>
<span>  data          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, N <span class="op">=</span> <span class="va">N</span><span class="op">)</span>,</span>
<span>  prior_list    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"sigma"</span> <span class="op">=</span> <span class="va">prior_sigma</span><span class="op">)</span>,</span>
<span></span>
<span>  <span class="co"># specification for the formula` part </span></span>
<span>  formula_list       <span class="op">=</span> <span class="va">formula_M0</span>,</span>
<span>  formula_prior_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mu"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"intercept"</span> <span class="op">=</span> <span class="va">prior_int</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  formula_data_list  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mu"</span> <span class="op">=</span> <span class="va">data_formula</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">marglik_model_H1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/JAGS_bridgesampling.html">JAGS_bridgesampling</a></span><span class="op">(</span></span>
<span>  fit           <span class="op">=</span> <span class="va">M1</span>,</span>
<span>  log_posterior <span class="op">=</span> <span class="va">log_posterior</span>,</span>
<span>  data          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, N <span class="op">=</span> <span class="va">N</span><span class="op">)</span>,</span>
<span>  prior_list    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"sigma"</span> <span class="op">=</span> <span class="va">prior_sigma</span><span class="op">)</span>,</span>
<span>  formula_list       <span class="op">=</span> <span class="va">formula_M1</span>,</span>
<span>  formula_prior_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mu"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"intercept"</span> <span class="op">=</span> <span class="va">prior_int</span>, <span class="st">"x"</span> <span class="op">=</span> <span class="va">prior_beta</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  formula_data_list  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mu"</span> <span class="op">=</span> <span class="va">data_formula</span><span class="op">)</span>,</span>
<span><span class="op">)</span></span></code></pre></div>
<p>We specify a BayesTools model ensemble object that we interrogate
with the <code>ensemble_inference_table</code> function for information
about the test for the beta parameter.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">models_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ensemble_inference.html">models_inference</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">M0</span>, marglik <span class="op">=</span> <span class="va">marglik_model_H0</span>, prior_weights <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">M1</span>, marglik <span class="op">=</span> <span class="va">marglik_model_H1</span>, prior_weights <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ensemble_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ensemble_inference.html">ensemble_inference</a></span><span class="op">(</span><span class="va">models_list</span>, parameters <span class="op">=</span> <span class="st">"x"</span>, is_null_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"x"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/BayesTools_ensemble_tables.html">ensemble_inference_table</a></span><span class="op">(</span><span class="va">ensemble_info</span>, parameters <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Models Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; x    1/2       0.500       0.541        1.181</span></span></code></pre></div>
<p>We find absence of evidence for either of the hypotheses,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">BF</mtext><mn>10</mn></msub><mo>=</mo><mn>1.181</mn></mrow><annotation encoding="application/x-tex">\text{BF}_{10} = 1.181</annotation></semantics></math>,
with posterior probability of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ℳ</mi><mn>1</mn></msub><mo>∣</mo><mtext mathvariant="normal">data</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.542</mn></mrow><annotation encoding="application/x-tex">P(\mathcal{M}_{1} \mid \text{data}) = 0.542</annotation></semantics></math>
(asuming equal prior probability specified via
<code>prior_weights</code> in the <code>models_inference</code> function
previously).</p>
</div>
<div class="section level2">
<h2 id="spike-and-slab-priors">Spike and Slab Priors<a class="anchor" aria-label="anchor" href="#spike-and-slab-priors"></a>
</h2>
<p>The <span class="citation">Kuo &amp; Mallick (1998)</span>’s spike an
slab prior distribution is specified as a mixture of two prior
distributions. A spike, a parameter value of zero corresponding to no
effect, and a slab, a parameter value sampled from a continuous density
corresponding to the alternative hypothesis. The parametrization uses
two independent prior distributions: one for the parameter value,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>∼</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta \sim g()</annotation></semantics></math>,
and one for the inclusion indicator,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>β</mi></msub><mo>∼</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">I_\beta \sim f()</annotation></semantics></math>,
which assigns the prior model probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ℳ</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(\mathcal{M}_{1})</annotation></semantics></math>
of inclusion.</p>
<p>The inclusion indicator can attain one of two values: either zero or
one. Multiplying the parameter with the inclusion indicator,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><msub><mi>I</mi><mi>β</mi></msub></mrow><annotation encoding="application/x-tex">\beta I_\beta</annotation></semantics></math>,
then results in setting the parameter to zero when the indicator is
zero, or keeping its original value when the indicator is one. The
proportion of times the indicator attains the value of one then
corresponds to the posterior inclusion probability of the predictor,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ℳ</mi><mn>1</mn></msub><mo>∣</mo><mtext mathvariant="normal">data</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(\mathcal{M}_{1} \mid \text{data})</annotation></semantics></math>.
Since Bayes factor can be written as the change from prior to posterior
odds,</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">BF</mtext><mn>10</mn></msub><mo>=</mo><mfrac><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ℳ</mi><mn>1</mn></msub><mo>∣</mo><mtext mathvariant="normal">data</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ℳ</mi><mn>0</mn></msub><mo>∣</mo><mtext mathvariant="normal">data</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mi>/</mi><mfrac><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ℳ</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ℳ</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{BF}_{10} = \frac{p(\mathcal{M}_{1} \mid \text{data})}{p(\mathcal{M}_{0} \mid \text{data})} / \frac{p(\mathcal{M}_{1})}{p(\mathcal{M}_{0})}</annotation></semantics></math>,</p>
<p>we can also estimate the Bayes factor via the inclusion
indicator.</p>
<p>Now, we compare the two models using the spike and slab prior. We
have already specified the likelihood, data lists, prior distributions
for the nuisance parameters, and even the formulas (now we need only
formula for the full model) in the previous sections. Therefore, we
proceed directly by specifying the spike and slab prior distribution for
the predictor. We use the <code>prior_spike_and_slab</code> which
follows similar notation as the <code>prior</code> function. We need to
specify the distribution, the parameters (and we could also set
truncation if needed) corresponding to the alternative hypothesis.
Furthermore, we need to specify the prior distribution for the inclusion
via the <code>prior_inclusion</code> argument. Here, we use a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Spike</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Spike}(0.5)</annotation></semantics></math>
prior which sets the prior inclusion probability to 1/2.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior_beta_spike_and_slab</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prior_spike_and_slab.html">prior_spike_and_slab</a></span><span class="op">(</span></span>
<span>  prior_parameter <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="st">"normal"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  prior_inclusion <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="st">"spike"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="op">)</span></span></code></pre></div>
<p>Then we can directly proceed to calling the <code>JAGS_fit</code>
function with the same specification as we used for the <code>M1</code>
model, however, changing the prior distribution object for the predictor
<code>x</code> to the newly created
<code>prior_beta_spike_and_slab</code> prior distribution.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/JAGS_fit.html">JAGS_fit</a></span><span class="op">(</span></span>
<span>  model_syntax <span class="op">=</span> <span class="va">model_likelihood</span>,</span>
<span>  data         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, N <span class="op">=</span> <span class="va">N</span><span class="op">)</span>,</span>
<span>  prior_list   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"sigma"</span> <span class="op">=</span> <span class="va">prior_sigma</span><span class="op">)</span>,</span>
<span>  formula_list       <span class="op">=</span> <span class="va">formula_M1</span>,</span>
<span>  formula_prior_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mu"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"intercept"</span> <span class="op">=</span> <span class="va">prior_int</span>, <span class="st">"x"</span> <span class="op">=</span> <span class="va">prior_beta_spike_and_slab</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  formula_data_list  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mu"</span> <span class="op">=</span> <span class="va">data_formula</span><span class="op">)</span>,</span>
<span>  seed         <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can again verify that our parameter estimates match the previous
results. Now, we need to set the <code>conditional = TRUE</code>
argument in the <code>JAGS_estimates_table</code> to obtain samples
assuming that the spike and slab parameter values are included. (The
function summarized the complete posterior distribution by default,
i.e., parameter estimates model-averaged across the spike and the
slab.)</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/BayesTools_model_tables.html">JAGS_estimates_table</a></span><span class="op">(</span><span class="va">MS</span>, conditional <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;                      Mean    SD    lCI Median    uCI</span></span>
<span><span class="co">#&gt; (mu) intercept     -0.540 0.106 -0.749 -0.540 -0.333</span></span>
<span><span class="co">#&gt; (mu) x (inclusion)  0.536    NA     NA     NA     NA</span></span>
<span><span class="co">#&gt; (mu) x              0.189 0.100 -0.009  0.190  0.385</span></span>
<span><span class="co">#&gt; sigma               1.050 0.076  0.912  1.047  1.211</span></span></code></pre></div>
<p>The estimates are essentially identical to the estimates from the
previous models. Finally, we can also obtain summary of the inclusion
probabilities via the <code>JAGS_inference_table</code> function</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/BayesTools_model_tables.html">JAGS_inference_table</a></span><span class="op">(</span><span class="va">MS</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; (mu) x       0.500       0.536        1.157</span></span></code></pre></div>
<p>As before, we find absence of evidence for either of the hypotheses,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">BF</mtext><mn>10</mn></msub><mo>=</mo><mn>1.157</mn></mrow><annotation encoding="application/x-tex">\text{BF}_{10} = 1.157</annotation></semantics></math>,
with posterior probability of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ℳ</mi><mn>1</mn></msub><mo>∣</mo><mtext mathvariant="normal">data</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.536</mn></mrow><annotation encoding="application/x-tex">P(\mathcal{M}_{1} \mid \text{data}) = 0.536</annotation></semantics></math>.</p>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-RoBSA" class="csl-entry">
Bartoš, F. (2022). <em><span>RoBSA</span>: <span>A</span>n
<span>R</span> package for robust <span>B</span>ayesian
survival-analyses</em>. <a href="https://CRAN.R-project.org/package=RoBSA" class="external-link">https://CRAN.R-project.org/package=RoBSA</a>
</div>
<div id="ref-RoBMA" class="csl-entry">
Bartoš, F., &amp; Maier, M. (2020). <em><span>RoBMA</span>:
<span>A</span>n <span>R</span> package for robust <span>B</span>ayesian
meta-analyses</em>. <a href="https://CRAN.R-project.org/package=RoBMA" class="external-link">https://CRAN.R-project.org/package=RoBMA</a>
</div>
<div id="ref-bridgesampling" class="csl-entry">
Gronau, Q. F., Singmann, H., &amp; Wagenmakers, E.-J. (2020). <span class="nocase">bridgesampling</span>: <span>A</span>n <span>R</span>
package for estimating normalizing constants. <em>Journal of Statistical
Software</em>, <em>92</em>(10), 1–29. <a href="https://doi.org/10.18637/jss.v092.i10" class="external-link">https://doi.org/10.18637/jss.v092.i10</a>
</div>
<div id="ref-kass1995bayes" class="csl-entry">
Kass, R. E., &amp; Raftery, A. E. (1995). <span>B</span>ayes factors.
<em>Journal of the American Statistical Association</em>,
<em>90</em>(430), 773–795. <a href="https://doi.org/10.1080/01621459.1995.10476572" class="external-link">https://doi.org/10.1080/01621459.1995.10476572</a>
</div>
<div id="ref-kuo1998variable" class="csl-entry">
Kuo, L., &amp; Mallick, B. (1998). Variable selection for regression
models. <em>Sankhy<span>ā</span>: The Indian Journal of Statistics,
Series B</em>, 65–81.
</div>
<div id="ref-ohara2009review" class="csl-entry">
O’Hara, R. B., &amp; Sillanpää, M. J. (2009). A review of bayesian
variable selection methods: What, how and which. <em>Bayesian
Analysis</em>, <em>4</em>(1), 85–117. <a href="https://doi.org/10.1214/09-BA403" class="external-link">https://doi.org/10.1214/09-BA403</a>
</div>
<div id="ref-JAGS" class="csl-entry">
Plummer, M. (2003). <span>JAGS</span>: A program for analysis of
<span>B</span>ayesian graphical models using <span>G</span>ibbs
sampling. <em>Proceedings of the 3rd International Workshop on
Distributed Statistical Computing</em>, <em>124</em>, 1–10.
</div>
<div id="ref-rouder2019teaching" class="csl-entry">
Rouder, J. N., &amp; Morey, R. D. (2019). Teaching <span>B</span>ayes’
theorem: Strength of evidence as predictive accuracy. <em>The American
Statistician</em>, <em>73</em>(2), 186–190. <a href="https://doi.org/10.1080/00031305.2017.1341334" class="external-link">https://doi.org/10.1080/00031305.2017.1341334</a>
</div>
<div id="ref-wrinch1921on" class="csl-entry">
Wrinch, D., &amp; Jeffreys, H. (1921). On certain fundamental principles
of scientific inquiry. <em>Philosophical Magazine</em>, <em>42</em>,
369–390. <a href="https://doi.org/10.1080/14786442108633773" class="external-link">https://doi.org/10.1080/14786442108633773</a>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by František Bartoš.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
